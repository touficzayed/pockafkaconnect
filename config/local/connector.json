{
  "name": "banking-s3-sink-local",
  "config": {
    "connector.class": "io.confluent.connect.s3.S3SinkConnector",
    "tasks.max": "3",
    "topics": "payments-in",
    "consumer.override.auto.offset.reset": "earliest",
    "consumer.override.max.poll.records": "500",

    "s3.bucket.name": "banking-payments",
    "s3.region": "us-east-1",
    "store.url": "http://minio:9000",
    "aws.access.key.id": "minioadmin",
    "aws.secret.access.key": "minioadmin",
    "s3.path.style.access.enabled": "true",

    "format.class": "io.confluent.connect.s3.format.json.JsonFormat",
    "storage.class": "io.confluent.connect.s3.storage.S3Storage",

    "rotate.schedule.interval.ms": "300000",
    "flush.size": "1000",
    "filename.offset.zero.pad.width": "10",
    "s3.object.tagging": "true",

    "partitioner.class": "com.banking.kafka.partitioner.BankingHierarchicalPartitioner",
    "partitioner.institution.header": "X-Institution-Id",
    "partitioner.event.type.header": "X-Event-Type",
    "partitioner.event.version.header": "X-Event-Version",
    "partitioner.default.institution": "UNKNOWN",
    "partitioner.default.event.type": "UNCLASSIFIED",
    "partitioner.default.event.version": "v0",

    "transforms": "headersToPayload,panTransform,jsonlFormat",

    "transforms.headersToPayload.type": "com.banking.kafka.transforms.HeadersToPayloadTransform",
    "transforms.headersToPayload.mandatory.headers": "X-Institution-Id,X-Event-Type,X-Event-Version",
    "transforms.headersToPayload.optional.headers": "X-Original-Request-Id,X-Original-Correlation-Id,Original-Idempotency-Key,X-User-Id,X-User-Context-Id",
    "transforms.headersToPayload.target.field": "headers",
    "transforms.headersToPayload.fail.on.missing.mandatory": "true",

    "transforms.panTransform.type": "com.banking.kafka.transforms.PANTransformationSMT",
    "transforms.panTransform.strategy": "DECRYPT",
    "transforms.panTransform.source.field": "encryptedPrimaryAccountNumber",
    "transforms.panTransform.target.field": "primaryAccountNumber",
    "transforms.panTransform.key.storage.provider": "FILE",
    "transforms.panTransform.private.key.path": "/keys/my-institution/private-key.pem",
    "transforms.panTransform.private.key.id": "my-key-2026-01",
    "transforms.panTransform.partner.keys.mapping.path": "/config/partner-keys-mapping.json",
    "transforms.panTransform.institution.header": "X-Institution-Id",
    "transforms.panTransform.jwe.algorithm": "RSA-OAEP-256",
    "transforms.panTransform.jwe.encryption": "A256GCM",

    "transforms.jsonlFormat.type": "com.banking.kafka.transforms.JSONLFormatTransform",
    "transforms.jsonlFormat.compact": "true",

    "pgp.encryption.enabled": "false",

    "errors.tolerance": "all",
    "errors.log.enable": "true",
    "errors.log.include.messages": "true",
    "errors.deadletterqueue.topic.name": "banking-payments-dlq",
    "errors.deadletterqueue.topic.replication.factor": "1",
    "errors.deadletterqueue.context.headers.enable": "true",
    "errors.retry.timeout": "60000",
    "errors.retry.delay.max.ms": "5000",

    "s3.part.size": "5242880"
  }
}
