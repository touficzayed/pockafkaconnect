{
  "name": "banking-s3-sink-multibank",
  "config": {
    "connector.class": "io.confluent.connect.s3.S3SinkConnector",
    "tasks.max": "3",
    "topics": "payments-in",

    "s3.bucket.name": "banking-payments",
    "s3.region": "us-east-1",
    "s3.part.size": "5242880",
    "flush.size": "100",
    "rotate.schedule.interval.ms": "60000",
    "timezone": "UTC",

    "storage.class": "io.confluent.connect.s3.storage.S3Storage",
    "format.class": "io.confluent.connect.s3.format.json.JsonFormat",

    "partitioner.class": "com.banking.kafka.partitioner.BankingHierarchicalPartitioner",
    "partitioner.institution.header": "X-Institution-Id",
    "partitioner.event.type.header": "X-Event-Type",
    "partitioner.event.version.header": "X-Event-Version",
    "partitioner.default.institution": "UNKNOWN",
    "partitioner.default.event.type": "UNCLASSIFIED",
    "partitioner.default.event.version": "v0",

    "key.converter": "org.apache.kafka.connect.json.JsonConverter",
    "value.converter": "org.apache.kafka.connect.json.JsonConverter",
    "key.converter.schemas.enable": "false",
    "value.converter.schemas.enable": "false",

    "transforms": "extractHeaders,transformPANPerBank",

    "transforms.extractHeaders.type": "com.banking.kafka.transforms.HeadersToPayloadTransform",
    "transforms.extractHeaders.mandatory.headers": "X-Institution-Id,X-Event-Type,X-Event-Version",
    "transforms.extractHeaders.optional.headers": "X-User-Id,X-Original-Request-Id,X-Correlation-Id",
    "transforms.extractHeaders.target.field": "metadata",
    "transforms.extractHeaders.fail.on.missing.mandatory": "false",

    "transforms.transformPANPerBank.type": "com.banking.kafka.transforms.PANTransformationSMT",
    "transforms.transformPANPerBank.bank.config.path": "/config/banks/bank-config.json",
    "transforms.transformPANPerBank.institution.id.header": "X-Institution-Id",

    "store.url": "http://minio:9000",
    "aws.access.key.id": "minioadmin",
    "aws.secret.access.key": "minioadmin",

    "errors.tolerance": "all",
    "errors.log.enable": "true",
    "errors.log.include.messages": "true",
    "errors.deadletterqueue.topic.name": "banking-payments-dlq",
    "errors.deadletterqueue.topic.replication.factor": "1",
    "errors.deadletterqueue.context.headers.enable": "true"
  }
}
